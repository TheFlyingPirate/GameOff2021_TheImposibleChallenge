pico-8 cartridge // http://www.pico-8.com
version 33
__lua__
--variables

function _init()
  player={
	   sp=1,
	   health=100,
	   x=79,
	   y=39,
	   w=8,
	   h=8,
	   flp_x=false,
	   flp_y=false,
	   dx=0,
	   dy=0,
	   max_dx=2,
	   max_dy=3,
	   acc=0.5,
	   jump_acc=2,
	   anim=0,
	   running=false,
	   jumping=false,
	   falling=false,
	   damage=false
	 }
	 gravity=0.3
	 friction=0.85
	 level=0
end

-->8
--update and draw
function _update()
  player_update()
  player_animate()
end

function _draw()
  cls()
  spr(16,0,0,1,1,false)
  print(player.health.."/100",9,2)
  map(0,0)
  spr(player.sp,player.x,player.y,1,1,player.flp_x)
end

function draw_mainmenu()


end
-->8
--collission
function collide_map(obj,aim,flag)
  --obj table(x,y,w,h)
  local x = obj.x
  local y = obj.y
  local w = obj.w
  local h = obj.h
  
  local x1 = 0
  local x2 = 0
  local y1 = 0
  local y2 = 0
  
  if aim=="left" then
    x1=x-1
    y1=y
    x2=x
    y2=y+h-1
  elseif aim=="right" then
    x1=x
    y1=y
    x2=x+w+1
    y2=y+h-1
  elseif aim=="up" then
    x1=x+1
    y1=y-1
    x2=x+w-1
    y2=y
  elseif aim=="down" then
    x1=x
    y1=y+h
    x2=x+w
    y2=y+h
  end
  --pixels to tiles
  x1/=8
  x2/=8
  y1/=8
  y2/=8
  
  if fget(mget(x1,y1),flag)
  or fget(mget(x1,y2),flag)
  or fget(mget(x2,y2),flag)
  or fget(mget(x2,y1),flag)
  then
    return true
  else
    return false
  end
end
-->8
--player update
function player_update()
  --physics
  player.dy+=gravity
  player.dx*=friction
  
  --controls
  if btn(⬅️) then
    player.flp_x = true
    player.dx+=player.acc
    player.running = true
  end
  if btn(➡️) then
    player.flp_x = false
    player.dx+=player.acc
    player.running = true
  end
  if btnp(❎) and player.landed then
    player.dy-=player.jump_acc
    player.jumping = true
    player.landed = false
  end
  
  --check collission
  if player.dy>0 then
    player.falling=true
    player.landed=false
    player.jumping= false
    
    if collide_map(player,"down",0) then
      player.landed=true
      player.falling=false
      player.dy=0
      player.y -=(player.y+player.h)%8
    end
  elseif player.dy<0 then
    player.jumping=true
    if collide_map(player,up,1) then
      player.dy=0
    end  
  end
  
  
  if player.dx>0 then
    if player.flp_x then
      if collide_map(player,"left",1) then
        if player.dx >=3 then
          player.health -=1
        end
        player.dx=0
        
      end
    else
      if collide_map(player,"right",1) then
      if player.dx>=3 then
        player.health -=1
      end
      player.dx=0
      end
    end
  end
  
  
  
  
  player.y+=player.dy
  if player.flp_x== true then
    player.x-=player.dx
  else
    player.x+=player.dx
  end
end
-->8
--player animate function
function player_animate()

end
__gfx__
00000000003333000033330000333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000033333000333330003333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000378f8000378f8000378f800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700003ffff0003ffff0003ffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000bb000000bb0f00f0bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000bbbb0000bbbb0000bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000f0b60f00fbb6000000b66f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000b006000000060000b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08800880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbb3bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3bb333b3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3bb33333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5040404040404040404040504040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000a0000000000000000000000001e550195502255000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
